layui.define(["laytpl","laypage","layer","form","util"],function(an){var aa=layui.$,aj=layui.laytpl,ar=layui.laypage,ah=layui.layer,af=layui.form,ae=(layui.util,layui.hint()),ac=layui.device(),ao={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?layui.table.index+10000:0,set:function(b){var a=this;return a.config=aa.extend({},a.config,b),a},on:function(b,a){return layui.onevent.call(this,Z,b,a)}},ap=function(){var c=this,b=c.config,a=b.id||b.index;return a&&(ap.that[a]=c,ap.config[a]=b),{reload:function(d){c.reload.call(c,d)},setColsWidth:function(){c.setColsWidth.call(c)},resize:function(){c.resize.call(c)},config:b}},ab=function(b){var a=ap.config[b];return a||ae.error("The ID option was not found in the table instance"),a||null},Z="table",ak=".layui-table",U="layui-hide",am="layui-none",ad="layui-table-view",Y=".layui-table-tool",ag=".layui-table-box",al=".layui-table-init",aq=".layui-table-header",V=".layui-table-body",ai=".layui-table-main",O=".layui-table-fixed",X=".layui-table-fixed-l",q=".layui-table-fixed-r",P=".layui-table-total",I=".layui-table-page",B=".layui-table-sort",G="layui-table-edit",j="layui-table-hover",at=function(b){var a='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';return b=b||{},['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){return b.fixed&&"right"!==b.fixed?'{{# if(item2.fixed && item2.fixed !== "right"){ }}':"right"===b.fixed?'{{# if(item2.fixed === "right"){ }}':""}(),"{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+a+' {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",b.fixed?"{{# }; }}":"","{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},M=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),Q=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# if(d.data.loading){ }}",'<div class="layui-table-init" style="background-color: #fff;">','<i class="layui-icon layui-icon-loading layui-icon"></i>',"</div>","{{# } }}","{{# var left, right; }}",'<div class="layui-table-header">',at(),"</div>",'<div class="layui-table-body layui-table-main">',M,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',at({fixed:!0}),"</div>",'<div class="layui-table-body">',M,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',at({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',M,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),J=aa(window),D=aa(document),K=function(b){var a=this;a.index=++ao.index,a.config=aa.extend({},a.config,ao.config,b),a.render()};K.prototype.config={limit:10,loading:!0,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoSort:!0,text:{none:"无数据"}},K.prototype.render=function(){var f=this,c=f.config;if(c.elem=aa(c.elem),c.where=c.where||{},c.id=c.id||c.elem.attr("id")||f.index,c.request=aa.extend({pageName:"page",limitName:"limit"},c.request),c.response=aa.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",countName:"count"},c.response),"object"==typeof c.page&&(c.limit=c.page.limit||c.limit,c.limits=c.page.limits||c.limits,f.page=c.page.curr=c.page.curr||1,delete c.page.elem,delete c.page.jump),!c.elem[0]){return f}c.height&&/^full-\d+$/.test(c.height)&&(f.fullHeightGap=c.height.split("-")[1],c.height=J.height()-f.fullHeightGap),f.setInit();var b=c.elem,h=b.next("."+ad),g=f.elem=aa(aj(Q).render({VIEW_CLASS:ad,data:c,index:f.index}));if(c.index=f.index,h[0]&&h.remove(),b.after(g),f.layTool=g.find(Y),f.layBox=g.find(ag),f.layHeader=g.find(aq),f.layMain=g.find(ai),f.layBody=g.find(V),f.layFixed=g.find(O),f.layFixLeft=g.find(X),f.layFixRight=g.find(q),f.layTotal=g.find(P),f.layPage=g.find(I),f.renderToolbar(),f.fullSize(),c.cols.length>1){var d=f.layFixed.find(aq).find("th");d.height(f.layHeader.height()-1-parseFloat(d.css("padding-top"))-parseFloat(d.css("padding-bottom")))}f.pullData(f.page),f.events()},K.prototype.initOpts=function(c){var b=this,a=(b.config,{checkbox:48,radio:48,space:15,numbers:40});c.checkbox&&(c.type="checkbox"),c.space&&(c.type="space"),c.type||(c.type="normal"),"normal"!==c.type&&(c.unresize=!0,c.width=c.width||a[c.type])},K.prototype.setInit=function(c){var b=this,a=b.config;return a.clientWidth=a.width||function(){var d=function(g){var f,e;g=g||a.elem.parent(),f=g.width();try{e="none"===g.css("display")}catch(h){}return !g[0]||f&&!e?f:d(g.parent())};return d()}(),"width"===c?a.clientWidth:void layui.each(a.cols,function(f,d){layui.each(d,function(e,h){if(!h){return void d.splice(e,1)}if(h.key=f+"-"+e,h.hide=h.hide||!1,h.colGroup||h.colspan>1){var g=0;layui.each(a.cols[f+1],function(l,k){k.HAS_PARENT||g>1&&g==h.colspan||(k.HAS_PARENT=!0,k.parentKey=f+"-"+e,g+=parseInt(k.colspan>1?k.colspan:1))}),h.colGroup=!0}b.initOpts(h)})})},K.prototype.renderToolbar=function(){var g=this,c=g.config,b=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),k=g.layTool.find(".layui-table-tool-temp");if("default"===c.toolbar){k.html(b)}else{if("string"==typeof c.toolbar){var i=aa(c.toolbar).html()||"";i&&k.html(aj(i).render(c))}}var f={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},h=[];"object"==typeof c.defaultToolbar&&layui.each(c.defaultToolbar,function(l,d){var a=f[d];a&&h.push('<div class="layui-inline" title="'+a.title+'" lay-event="'+a.layEvent+'"><i class="layui-icon '+a.icon+'"></i></div>')}),g.layTool.find(".layui-table-tool-self").html(h.join(""))},K.prototype.setParentCol=function(k,s){var h=this,p=h.config,g=h.layHeader.find('th[data-key="'+p.index+"-"+s+'"]'),f=parseInt(g.attr("colspan"))||0;if(g[0]){var c=s.split("-"),b=p.cols[c[0]][c[1]];k?f--:f++,g.attr("colspan",f),g[f<1?"addClass":"removeClass"](U),b.colspan=f,b.hide=f<1;var m=g.data("parentkey");m&&h.setParentCol(k,m)}},K.prototype.setColsPatch=function(){var b=this,a=b.config;layui.each(a.cols,function(d,c){layui.each(c,function(f,e){e.hide&&b.setParentCol(e.hide,e.parentKey)})})},K.prototype.setColsWidth=function(){var m=this,y=m.config,k=0,w=0,h=0,g=0,f=m.setInit("width");m.eachCols(function(c,a){a.hide||k++}),f=f-function(){return"line"===y.skin||"nob"===y.skin?2:k+1}()-m.getScrollWidth(m.layMain[0])-1;var b=function(a){layui.each(y.cols,function(c,d){layui.each(d,function(e,n){var o=0,l=n.minWidth||y.cellMinWidth;return n?void (n.colGroup||n.hide||(a?h&&h<l&&(w--,o=l):(o=n.width||0,/\d+%$/.test(o)?(o=Math.floor(parseFloat(o)/100*f),o<l&&(o=l)):o||(n.width=o=0,w++)),n.hide&&(o=0),g+=o)):void d.splice(e,1)})}),f>g&&w&&(h=(f-g)/w)};b(),b(!0),m.autoColNums=w,m.eachCols(function(d,c){var e=c.minWidth||y.cellMinWidth;c.colGroup||c.hide||(0===c.width?m.getCssRule(y.index+"-"+c.key,function(a){a.style.width=Math.floor(h>=e?h:e)+"px"}):/\d+%$/.test(c.width)&&m.getCssRule(y.index+"-"+c.key,function(a){a.style.width=Math.floor(parseFloat(c.width)/100*f)+"px"}))});var p=m.layMain.width()-m.getScrollWidth(m.layMain[0])-m.layMain.children("table").outerWidth();if(m.autoColNums&&p>=-k&&p<=k){var v=function(c){var a;return c=c||m.layHeader.eq(0).find("thead th:last-child"),a=c.data("field"),!a&&c.prev()[0]?v(c.prev()):c},z=v(),x=z.data("key");m.getCssRule(x,function(c){var a=c.style.width||z.outerWidth();c.style.width=parseFloat(a)+p+"px",m.layMain.height()-m.layMain.prop("clientHeight")>0&&(c.style.width=parseFloat(c.style.width)-1+"px")})}m.loading(!0)},K.prototype.resize=function(){var a=this;a.fullSize(),a.setColsWidth(),a.scrollPatch()},K.prototype.reload=function(b){var a=this;a.config.data&&a.config.data.constructor===Array&&delete a.config.data,a.config=aa.extend({},a.config,b),a.render()},K.prototype.page=1,K.prototype.pullData=function(m){var k=this,u=k.config,h=u.request,g=u.response,f=function(){"object"==typeof u.initSort&&k.sort(u.initSort.field,u.initSort.type)};if(k.startTime=(new Date).getTime(),u.url){var b={};b[h.pageName]=m,b[h.limitName]=u.limit;var p=aa.extend(b,u.where);u.contentType&&0==u.contentType.indexOf("application/json")&&(p=JSON.stringify(p)),aa.ajax({type:u.method||"get",url:u.url,contentType:u.contentType,data:p,dataType:"json",headers:u.headers||{},success:function(a){"function"==typeof u.parseData&&(a=u.parseData(a)||a),a[g.statusName]!=g.statusCode?(k.renderForm(),k.layMain.html('<div class="'+am+'">'+(a[g.msgName]||"返回的数据不符合规范，正确的成功状态码 ("+g.statusName+") 应为："+g.statusCode)+"</div>")):(k.renderData(a,m,a[g.countName]),f(),u.time=(new Date).getTime()-k.startTime+" ms"),k.setColsWidth(),"function"==typeof u.done&&u.done(a,m,a[g.countName])},error:function(c,a){k.layMain.html('<div class="'+am+'">数据接口请求异常：'+a+"</div>"),k.renderForm(),k.setColsWidth()}})}else{if(u.data&&u.data.constructor===Array){var t={},v=m*u.limit-u.limit;t[g.dataName]=u.data.concat().splice(v,u.limit),t[g.countName]=u.data.length,k.renderData(t,m,u.data.length),f(),k.setColsWidth(),"function"==typeof u.done&&u.done(t,m,t[g.countName])}}},K.prototype.eachCols=function(b){var a=this;return ao.eachCols(null,b,a.config.cols),a},K.prototype.renderData=function(k,f,d,a){var l=this,x=l.config,w=k[x.response.dataName]||[],i=[],b=[],t=[],g=function(){var c;return !a&&l.sortKey?l.sort(l.sortKey.field,l.sortKey.sort,!0):(layui.each(w,function(n,h){var s=[],p=[],r=[],e=n+x.limit*(f-1)+1;0!==h.length&&(a||(h[ao.config.indexName]=n),l.eachCols(function(A,u){var z=u.field||A,o=x.index+"-"+u.key,y=h[z];if(void 0!==y&&null!==y||(y=""),!u.colGroup){var m=['<td data-field="'+z+'" data-key="'+o+'" '+function(){var v=[];return u.edit&&v.push('data-edit="'+u.edit+'"'),u.align&&v.push('align="'+u.align+'"'),u.templet&&v.push('data-content="'+y+'"'),u.toolbar&&v.push('data-off="true"'),u.event&&v.push('lay-event="'+u.event+'"'),u.style&&v.push('style="'+u.style+'"'),u.minWidth&&v.push('data-minwidth="'+u.minWidth+'"'),v.join(" ")}()+' class="'+function(){var v=[];return u.hide&&v.push(U),u.field||v.push("layui-table-col-special"),v.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){return"normal"===u.type?o:o+" laytable-cell-"+u.type}()+'">'+function(){var C=aa.extend(!0,{LAY_INDEX:e},h),v=ao.config.checkName;switch(u.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+function(){return u[v]?(h[v]=u[v],u[v]?"checked":""):C[v]?"checked":""}()+">";case"radio":return C[v]&&(c=n),'<input type="radio" name="layTableRadio_'+x.index+'" '+(C[v]?"checked":"")+' lay-type="layTableRadio">';case"numbers":return e}return u.toolbar?aj(aa(u.toolbar).html()||"").render(C):u.templet?function(){return"function"==typeof u.templet?u.templet(C):aj(aa(u.templet).html()||String(y)).render(C)}():y}(),"</div></td>"].join("");s.push(m),u.fixed&&"right"!==u.fixed&&p.push(m),"right"===u.fixed&&r.push(m)}}),i.push('<tr data-index="'+n+'">'+s.join("")+"</tr>"),b.push('<tr data-index="'+n+'">'+p.join("")+"</tr>"),t.push('<tr data-index="'+n+'">'+r.join("")+"</tr>"))}),l.layBody.scrollTop(0),l.layMain.find("."+am).remove(),l.layMain.find("tbody").html(i.join("")),l.layFixLeft.find("tbody").html(b.join("")),l.layFixRight.find("tbody").html(t.join("")),l.renderForm(),"number"==typeof c&&l.setThisRowChecked(c),l.syncCheckAll(),l.haveInit?l.scrollPatch():setTimeout(function(){l.scrollPatch()},50),l.haveInit=!0,ah.close(l.tipsIndex),x.HAS_SET_COLS_PATCH||l.setColsPatch(),void (x.HAS_SET_COLS_PATCH=!0))};return l.key=x.id||x.index,ao.cache[l.key]=w,l.layPage[0==d||0===w.length&&1==f?"addClass":"removeClass"](U),a?g():0===w.length?(l.renderForm(),l.layFixed.remove(),l.layMain.find("tbody").html(""),l.layMain.find("."+am).remove(),l.layMain.append('<div class="'+am+'">'+x.text.none+"</div>")):(g(),l.renderTotal(w),void (x.page&&(x.page=aa.extend({elem:"layui-table-page"+x.index,count:d,limit:x.limit,limits:x.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(h,c){c||(l.page=h.curr,x.limit=h.limit,l.loading(),l.pullData(h.curr))}},x.page),x.page.count=d,ar.render(x.page))))},K.prototype.renderTotal=function(g){var f=this,d=f.config,c={};if(d.totalRow){layui.each(g,function(h,a){0!==a.length&&f.eachCols(function(m,k){var i=k.field||m,o=a[i];k.totalRow&&(c[i]=(c[i]||0)+(parseFloat(o)||0))})});var b=[];f.eachCols(function(h,a){var k=a.field||h,i=['<td data-field="'+k+'" data-key="'+d.index+"-"+a.key+'" '+function(){var l=[];return a.align&&l.push('align="'+a.align+'"'),a.style&&l.push('style="'+a.style+'"'),a.minWidth&&l.push('data-minwidth="'+a.minWidth+'"'),l.join(" ")}()+' class="'+function(){var l=[];return a.hide&&l.push(U),a.field||l.push("layui-table-col-special"),l.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){var l=d.index+"-"+a.key;return"normal"===a.type?l:l+" laytable-cell-"+a.type}()+'">'+function(){var l=a.totalRowText||"";return a.totalRow?parseFloat(c[k]).toFixed(2)||l:l}(),"</div></td>"].join("");b.push(i)}),f.layTotal.find("tbody").html("<tr>"+b.join("")+"</tr>")}},K.prototype.getColElem=function(f,d){var c=this,b=c.config;return f.eq(0).find(".laytable-cell-"+(b.index+"-"+d)+":eq(0)")},K.prototype.renderForm=function(a){af.render(a,"LAY-table-"+this.index)},K.prototype.setThisRowChecked=function(f){var d=this,c=(d.config,"layui-table-click"),b=d.layBody.find('tr[data-index="'+f+'"]');b.addClass(c).siblings("tr").removeClass(c)},K.prototype.sort=function(x,t,C,o){var g,b,z=this,F={},u=z.config,A=u.elem.attr("lay-filter"),w=ao.cache[z.key];"string"==typeof x&&z.layHeader.find("th").each(function(f,e){var c=aa(this),h=c.data("field");if(h===x){return x=c,g=h,!1}});try{var g=g||x.data("field"),d=x.data("key");if(z.sortKey&&!C&&g===z.sortKey.field&&t===z.sortKey.sort){return}var E=z.layHeader.find("th .laytable-cell-"+d).find(B);z.layHeader.find("th").find(B).removeAttr("lay-sort"),E.attr("lay-sort",t||null),z.layFixed.find("th")}catch(k){return ae.error("Table modules: Did not match to field")}z.sortKey={field:g,sort:t},u.autoSort&&("asc"===t?b=layui.sort(w,g):"desc"===t?b=layui.sort(w,g,!0):(b=layui.sort(w,ao.config.indexName),delete z.sortKey)),F[u.response.dataName]=b||w,z.renderData(F,z.page,z.count,!0),o&&layui.event.call(x,Z,"sort("+A+")",{field:g,type:t})},K.prototype.loading=function(d){var c=this,b=c.config;b.loading&&(d?(c.layInit&&c.layInit.remove(),delete c.layInit,c.layBox.find(al).remove()):(c.layInit=aa(['<div class="layui-table-init">','<i class="layui-icon layui-icon-loading layui-icon"></i>',"</div>"].join("")),c.layBox.append(c.layInit)))},K.prototype.setCheckData=function(g,f){var d=this,c=d.config,b=ao.cache[d.key];b[g]&&b[g].constructor!==Array&&(b[g][c.checkName]=f)},K.prototype.syncCheckAll=function(){var f=this,d=f.config,c=f.layHeader.find('input[name="layTableCheckbox"]'),b=function(a){return f.eachCols(function(h,g){"checkbox"===g.type&&(g[d.checkName]=a)}),a};c[0]&&(ao.checkStatus(f.key).isAll?(c[0].checked||(c.prop("checked",!0),f.renderForm("checkbox")),b(!0)):(c[0].checked&&(c.prop("checked",!1),f.renderForm("checkbox")),b(!1)))},K.prototype.getCssRule=function(g,f){var d=this,c=d.elem.find("style")[0],b=c.sheet||c.styleSheet||{},h=b.cssRules||b.rules;layui.each(h,function(k,e){if(e.selectorText===".laytable-cell-"+g){return f(e),!0}})},K.prototype.fullSize=function(){var f,d=this,c=d.config,b=c.height;d.fullHeightGap&&(b=J.height()-d.fullHeightGap,b<135&&(b=135),d.elem.css("height",b)),b&&(f=parseFloat(b)-(d.layHeader.outerHeight()||38),c.toolbar&&(f-=d.layTool.outerHeight()||50),c.totalRow&&(f-=d.layTotal.outerHeight()||40),c.page&&(f=f-(d.layPage.outerHeight()||41)-2),d.layMain.css("height",f))},K.prototype.getScrollWidth=function(b){var a=0;return b?a=b.offsetWidth-b.clientWidth:(b=document.createElement("div"),b.style.width="100px",b.style.height="100px",b.style.overflowY="scroll",document.body.appendChild(b),a=b.offsetWidth-b.clientWidth,document.body.removeChild(b)),a},K.prototype.scrollPatch=function(){var h=this,f=h.layMain.children("table"),c=h.layMain.width()-h.layMain.prop("clientWidth"),b=h.layMain.height()-h.layMain.prop("clientHeight"),p=(h.getScrollWidth(h.layMain[0]),f.outerWidth()-h.layMain.width()),m=function(d){if(c&&b){if(d=d.eq(0),!d.find(".layui-table-patch")[0]){var a=aa('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');a.find("div").css({width:c}),d.find("tr").append(a)}}else{d.find(".layui-table-patch").remove()}};m(h.layHeader),m(h.layTotal);var g=h.layMain.height(),k=g-b;h.layFixed.find(V).css("height",f.height()>=k?k:"auto"),h.layFixRight[p>0?"removeClass":"addClass"](U),h.layFixRight.css("right",c-1)},K.prototype.events=function(){var t,x=this,i=x.config,u=aa("body"),z={},l=x.layHeader.find("th"),r=".layui-table-cell",d=i.elem.attr("lay-filter");x.layTool.on("click","*[lay-event]",function(p){var b=aa(this),A=b.attr("lay-event"),m=function(f){var c=aa(f.list),h=aa('<ul class="layui-table-tool-panel"></ul>');h.html(c),i.height&&h.css("max-height",i.height-(x.layTool.outerHeight()||50)),b.find(".layui-table-tool-panel")[0]||b.append(h),x.renderForm(),h.on("click",function(s){layui.stope(s)}),f.done&&f.done(h,c)};switch(layui.stope(p),D.trigger("table.tool.panel.remove"),ah.close(x.tipsIndex),A){case"LAYTABLE_COLS":m({list:function(){var c=[];return x.eachCols(function(f,e){e.field&&"normal"==e.type&&c.push('<li><input type="checkbox" name="'+e.field+'" data-key="'+e.key+'" data-parentkey="'+(e.parentKey||"")+'" lay-skin="primary" '+(e.hide?"":"checked")+' title="'+(e.title||e.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}),c.join("")}(),done:function(){af.on("checkbox(LAY_TABLE_TOOL_COLS)",function(s){var f=aa(s.elem),c=this.checked,v=f.data("key"),h=f.data("parentkey");layui.each(i.cols,function(E,C){layui.each(C,function(F,e){if(E+"-"+F===v){var H=e.hide;e.hide=!c,x.elem.find('*[data-key="'+i.index+"-"+v+'"]')[c?"removeClass":"addClass"](U),H!=e.hide&&x.setParentCol(!c,h),x.resize()}})})})}});break;case"LAYTABLE_EXPORT":ac.ie?ah.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3}):m({list:function(){return['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join("")}(),done:function(f,c){c.on("click",function(){var h=aa(this).data("type");ao.exportFile(i.id,null,h)})}});break;case"LAYTABLE_PRINT":var g=window.open("打印窗口","_blank"),o=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),a=aa(x.layHeader.html());a.append(x.layMain.find("table").html()),a.find("th.layui-table-patch").remove(),a.find(".layui-table-col-special").remove(),g.document.write(o+a.prop("outerHTML")),g.document.close(),g.print(),g.close()}layui.event.call(this,Z,"toolbar("+d+")",aa.extend({event:A,config:i},{}))}),l.on("mousemove",function(g){var f=aa(this),c=f.offset().left,b=g.clientX-c;f.data("unresize")||z.resizeStart||(z.allowResize=f.width()-b<=10,u.css("cursor",z.allowResize?"col-resize":""))}).on("mouseleave",function(){aa(this);z.resizeStart||u.css("cursor","")}).on("mousedown",function(c){var b=aa(this);if(z.allowResize){var a=b.data("key");c.preventDefault(),z.resizeStart=!0,z.offset=[c.clientX,c.clientY],x.getCssRule(a,function(g){var f=g.style.width||b.outerWidth();z.rule=g,z.ruleWidth=parseFloat(f),z.minWidth=b.data("minwidth")||i.cellMinWidth})}}),D.on("mousemove",function(b){if(z.resizeStart){if(b.preventDefault(),z.rule){var a=z.ruleWidth+b.clientX-z.offset[0];a<z.minWidth&&(a=z.minWidth),z.rule.style.width=a+"px",ah.close(x.tipsIndex)}t=1}}).on("mouseup",function(a){z.resizeStart&&(z={},u.css("cursor",""),x.scrollPatch()),2===t&&(t=null)}),l.on("click",function(b){var a,f=aa(this),e=f.find(B),c=e.attr("lay-sort");return e[0]&&1!==t?(a="asc"===c?"desc":"desc"===c?null:"asc",void x.sort(f,a,null,!0)):t=2}).find(B+" .layui-edge ").on("click",function(c){var b=aa(this),a=b.index(),f=b.parents("th").eq(0).data("field");layui.stope(c),0===a?x.sort(f,"asc",null,!0):x.sort(f,"desc",null,!0)});var y=function(c){var a=aa(this),g=a.parents("tr").eq(0).data("index"),f=x.layBody.find('tr[data-index="'+g+'"]'),b=ao.cache[x.key][g];return aa.extend({tr:f,data:ao.clearCacheKey(b),del:function(){ao.cache[x.key][g]=[],f.remove(),x.scrollPatch()},update:function(h){h=h||{},layui.each(h,function(o,m){if(o in b){var s,p=f.children('td[data-field="'+o+'"]');b[o]=m,x.eachCols(function(v,e){e.field==o&&e.templet&&(s=e.templet)}),p.children(r).html(function(){return s?function(){return"function"==typeof s?s(b):aj(aa(s).html()||m).render(b)}():m}()),p.data("content",m)}})}},c)};x.elem.on("click",'input[name="layTableCheckbox"]+',function(){var c=aa(this).prev(),b=x.layBody.find('input[name="layTableCheckbox"]'),a=c.parents("tr").eq(0).data("index"),g=c[0].checked,f="layTableAllChoose"===c.attr("lay-filter");f?(b.each(function(m,h){h.checked=g,x.setCheckData(m,g)}),x.syncCheckAll(),x.renderForm("checkbox")):(x.setCheckData(a,g),x.syncCheckAll()),layui.event.call(c[0],Z,"checkbox("+d+")",y.call(c[0],{checked:g,type:f?"all":"one"}))}),x.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var c=aa(this).prev(),b=c[0].checked,a=ao.cache[x.key],f=c.parents("tr").eq(0).data("index");layui.each(a,function(h,g){f===h?g.LAY_CHECKED=!0:delete g.LAY_CHECKED}),x.setThisRowChecked(f),layui.event.call(this,Z,"radio("+d+")",y.call(this,{checked:b}))}),x.layBody.on("mouseenter","tr",function(){var b=aa(this),a=b.index();x.layBody.find("tr:eq("+a+")").addClass(j)}).on("mouseleave","tr",function(){var b=aa(this),a=b.index();x.layBody.find("tr:eq("+a+")").removeClass(j)}).on("click","tr",function(){k.call(this,"row")}).on("dblclick","tr",function(){k.call(this,"rowDouble")});var k=function(b){var a=aa(this);layui.event.call(this,Z,b+"("+d+")",y.call(a.children("td")[0]))};x.layBody.on("change","."+G,function(){var c=aa(this),b=this.value,a=c.parent().data("field"),g=c.parents("tr").eq(0).data("index"),f=ao.cache[x.key][g];f[a]=b,layui.event.call(this,Z,"edit("+d+")",y.call(this,{value:b,field:a}))}).on("blur","."+G,function(){var c,a=aa(this),g=a.parent().data("field"),f=a.parents("tr").eq(0).data("index"),b=ao.cache[x.key][f];x.eachCols(function(h,e){e.field==g&&e.templet&&(c=e.templet)}),a.siblings(r).html(function(e){return c?function(){return"function"==typeof c?c(b):aj(aa(c).html()||this.value).render(b)}():e}(this.value)),a.parent().data("content",this.value),a.remove()}),x.layBody.on("click","td",function(g){var f=aa(this),c=(f.data("field"),f.data("edit")),b=f.children(r);if(!f.data("off")&&c){var h=aa('<input class="layui-input '+G+'">');return h[0].value=f.data("content")||b.text(),f.find("."+G)[0]||f.append(h),h.focus(),void layui.stope(g)}}).on("mouseenter","td",function(){w.call(this)}).on("mouseleave","td",function(){w.call(this,"hide")});var n="layui-table-grid-down",w=function(f){var c=aa(this),b=c.children(r);if(f){c.find(".layui-table-grid-down").remove()}else{if(b.prop("scrollWidth")>b.outerWidth()){if(b.find("."+n)[0]){return}c.append('<div class="'+n+'"><i class="layui-icon layui-icon-down"></i></div>')}}};x.layBody.on("click","."+n,function(b){var a=aa(this),f=a.parent(),c=f.children(r);x.tipsIndex=ah.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(c.height()+16)+"px;"+function(){return"sm"===i.size?"padding: 4px 15px; font-size: 12px;":"lg"===i.size?"padding: 14px 15px;":""}()+'">',c.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),c[0],{tips:[3,""],time:-1,anim:-1,maxWidth:ac.ios||ac.android?300:x.elem.width()/2,isOutAnim:!1,skin:"layui-table-tips",success:function(h,g){h.find(".layui-table-tips-c").on("click",function(){ah.close(g)})}}),layui.stope(b)}),x.layBody.on("click","*[lay-event]",function(){var b=aa(this),a=b.parents("tr").eq(0).data("index");layui.event.call(this,Z,"tool("+d+")",y.call(this,{event:b.attr("lay-event")})),x.setThisRowChecked(a)}),x.layMain.on("scroll",function(){var b=aa(this),a=b.scrollLeft(),c=b.scrollTop();x.layHeader.scrollLeft(a),x.layTotal.scrollLeft(a),x.layFixed.find(V).scrollTop(c),ah.close(x.tipsIndex)}),D.on("click",function(){D.trigger("table.remove.tool.panel")}),D.on("table.remove.tool.panel",function(){aa(".layui-table-tool-panel").remove()}),J.on("resize",function(){x.resize()})},ao.init=function(f,d){d=d||{};var c=this,b=aa(f?'table[lay-filter="'+f+'"]':ak+"[lay-data]"),g="Table element property lay-data configuration item has a syntax error: ";return b.each(function(){var h=aa(this),e=h.attr("lay-data");try{e=new Function("return "+e)()}catch(k){ae.error(g+e)}var m=[],i=aa.extend({elem:this,cols:[],data:[],skin:h.attr("lay-skin"),size:h.attr("lay-size"),even:"string"==typeof h.attr("lay-even")},ao.config,d,e);f&&h.hide(),h.find("thead>tr").each(function(a){i.cols[a]=[],aa(this).children().each(function(p){var o=aa(this),n=o.attr("lay-data");try{n=new Function("return "+n)()}catch(s){return ae.error(g+n)}var t=aa.extend({title:o.text(),colspan:o.attr("colspan")||0,rowspan:o.attr("rowspan")||0},n);t.colspan<2&&m.push(t),i.cols[a].push(t)})}),h.find("tbody>tr").each(function(o){var n=aa(this),l={};n.children("td").each(function(r,p){var a=aa(this),s=a.data("field");if(s){return l[s]=a.html()}}),layui.each(m,function(r,p){var a=n.children("td").eq(r);l[p.field]=a.html()}),i.data[o]=l}),ao.render(i)}),c},ap.that={},ap.config={},ao.eachCols=function(g,d,c){var b=ap.config[g]||{},k=[],h=0;c=aa.extend(!0,[],c||b.cols),layui.each(c,function(i,a){layui.each(a,function(n,m){if(m.colGroup){var e=0;h++,m.CHILD_COLS=[],layui.each(c[i+1],function(o,l){l.PARENT_COL_INDEX||e>1&&e==m.colspan||(l.PARENT_COL_INDEX=h,m.CHILD_COLS.push(l),e+=parseInt(l.colspan>1?l.colspan:1))})}m.PARENT_COL_INDEX||k.push(m)})});var f=function(a){layui.each(a||k,function(l,i){return i.CHILD_COLS?f(i.CHILD_COLS):void ("function"==typeof d&&d(l,i))})};f()},ao.checkStatus=function(g){var f=0,d=0,c=[],b=ao.cache[g]||[];return layui.each(b,function(h,a){return a.constructor===Array?void d++:void (a[ao.config.checkName]&&(f++,c.push(ao.clearCacheKey(a))))}),{data:c,isAll:!!b.length&&f===b.length-d}},ao.exportFile=function(g,f,d){f=f||ao.clearCacheKey(ao.cache[g]),d=d||"csv";var c=ap.config[g]||{},b={csv:"text/csv",xls:"application/vnd.ms-excel"}[d],h=document.createElement("a");return ac.ie?ae.error("IE_NOT_SUPPORT_EXPORTS"):(h.href="data:"+b+";charset=utf-8,\ufeff"+encodeURIComponent(function(){var k=[],e=[];return layui.each(f,function(i,a){var m=[];"object"==typeof g?(layui.each(g,function(n,l){0==i&&k.push(l||"")}),layui.each(ao.clearCacheKey(a),function(n,l){m.push(l)})):ao.eachCols(g,function(n,l){l.field&&"normal"==l.type&&!l.hide&&(0==i&&k.push(l.title||""),m.push(a[l.field]))}),e.push(m.join(","))}),k.join(",")+"\r\n"+e.join("\r\n")}()),h.download=(c.title||"table_"+(c.index||""))+"."+d,document.body.appendChild(h),h.click(),void document.body.removeChild(h))},ao.resize=function(b){if(b){var a=ab(b);if(!a){return}ap.that[b].resize()}else{layui.each(ap.that,function(){this.resize()})}},ao.reload=function(d,c){c=c||{};var b=ab(d);if(b){return c.data&&c.data.constructor===Array&&delete b.data,ao.render(aa.extend(!0,{},b,c))}},ao.render=function(b){var a=new K(b);return ap.call(a)},ao.clearCacheKey=function(a){return a=aa.extend({},a),delete a[ao.config.checkName],delete a[ao.config.indexName],a},ao.init(),an(Z,ao)});